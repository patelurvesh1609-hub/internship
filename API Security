PART 1ï¸âƒ£ â€” INSTALL SANCTUM
1ï¸âƒ£ Install Package
composer require laravel/sanctum

2ï¸âƒ£ Publish Config & Migration
php artisan vendor:publish --provider="Laravel\Sanctum\SanctumServiceProvider"
php artisan migrate

ðŸ“„ Table created:

personal_access_tokens

3ï¸âƒ£ Update User Model

ðŸ“„ app/Models/User.php

use Laravel\Sanctum\HasApiTokens;

class User extends Authenticatable
{
    use HasApiTokens, Notifiable;
}

PART 2ï¸âƒ£ â€” CREATE AUTH CONTROLLER
4ï¸âƒ£ Generate API Controller
php artisan make:controller Api/AuthController

ðŸ“„ File:

app/Http/Controllers/Api/AuthController.php

PART 3ï¸âƒ£ â€” REGISTER METHOD
use App\Models\User;
use Illuminate\Http\Request;
use Illuminate\Support\Facades\Hash;

public function register(Request $request)
{
    $request->validate([
        'name' => 'required|string',
        'email' => 'required|email|unique:users',
        'password' => 'required|min:6'
    ]);

    $user = User::create([
        'name' => $request->name,
        'email' => $request->email,
        'password' => Hash::make($request->password),
    ]);

    $token = $user->createToken('mobile-app')->plainTextToken;

    return response()->json([
        'user' => $user,
        'token' => $token
    ], 201);
}

PART 4ï¸âƒ£ â€” LOGIN METHOD
use Illuminate\Support\Facades\Auth;

public function login(Request $request)
{
    if (!Auth::attempt($request->only('email', 'password'))) {
        return response()->json([
            'message' => 'Invalid credentials'
        ], 401);
    }

    $user = Auth::user();

    $token = $user->createToken('mobile-app')->plainTextToken;

    return response()->json([
        'user' => $user,
        'token' => $token
    ]);
}

PART 5ï¸âƒ£ â€” LOGOUT METHOD
public function logout(Request $request)
{
    $request->user()->currentAccessToken()->delete();

    return response()->json([
        'message' => 'Logged out successfully'
    ]);
}

PART 6ï¸âƒ£ â€” PROTECT API ROUTES

ðŸ“„ routes/api.php

use App\Http\Controllers\Api\AuthController;

Route::post('/register', [AuthController::class, 'register']);
Route::post('/login', [AuthController::class, 'login']);

Route::middleware('auth:sanctum')->group(function () {

    Route::get('/profile', function (Request $request) {
        return $request->user();
    });

    Route::post('/logout', [AuthController::class, 'logout']);

});

PART 7ï¸âƒ£ â€” USING TOKEN (IMPORTANT ðŸ”¥)

Every protected request must include:

Authorization: Bearer YOUR_TOKEN_HERE


Example:

GET /api/profile
Authorization: Bearer 1|sd8f7sdf7sdf7...

PART 8ï¸âƒ£ â€” TOKEN ABILITIES (ADVANCED ðŸ”¥)
Create Token with Permissions
$token = $user->createToken('mobile-app', ['order:create', 'order:view'])->plainTextToken;

Check Permission
if (!$request->user()->tokenCan('order:create')) {
    abort(403);
}
