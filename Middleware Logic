PART 1ï¸âƒ£ â€” PREPARE DATABASE
1ï¸âƒ£ Add Role Column to Users Table

ğŸ“„ Migration

php artisan make:migration add_role_to_users_table

ğŸ“„ database/migrations/*_add_role_to_users_table.php

Schema::table('users', function (Blueprint $table) {
    $table->string('role')->default('user');
});

php artisan migrate

2ï¸âƒ£ Example User Roles in Database
id	name	role
1	John	admin
2	Mike	user
PART 2ï¸âƒ£ â€” CREATE CUSTOM MIDDLEWARE
3ï¸âƒ£ Generate Middleware
php artisan make:middleware RoleMiddleware

ğŸ“„ File Created

app/Http/Middleware/RoleMiddleware.php

4ï¸âƒ£ Add Role Logic

ğŸ“„ RoleMiddleware.php

<?php

namespace App\Http\Middleware;

use Closure;
use Illuminate\Http\Request;

class RoleMiddleware
{
    public function handle(Request $request, Closure $next, ...$roles)
    {
        if (!auth()->check()) {
            return redirect('/login');
        }

        if (!in_array(auth()->user()->role, $roles)) {
            abort(403, 'Unauthorized Access');
        }

        return $next($request);
    }
}

PART 3ï¸âƒ£ â€” REGISTER MIDDLEWARE

ğŸ“„ File

app/Http/Kernel.php


Add in $routeMiddleware:

'role' => \App\Http\Middleware\RoleMiddleware::class,

PART 4ï¸âƒ£ â€” APPLY MIDDLEWARE TO ROUTES
5ï¸âƒ£ Admin-Only Routes

ğŸ“„ routes/web.php

Route::middleware(['auth', 'role:admin'])
    ->prefix('admin')
    ->group(function () {

        Route::get('/dashboard', function () {
            return "Admin Dashboard";
        });

    });

6ï¸âƒ£ User-Only Routes
Route::middleware(['auth', 'role:user'])
    ->group(function () {

        Route::get('/profile', function () {
            return "User Profile";
        });

    });

7ï¸âƒ£ Multiple Roles Allowed
Route::middleware(['auth', 'role:admin,user'])
    ->get('/common', function () {
        return "Accessible by Admin & User";
    });

PART 5ï¸âƒ£ â€” CONTROLLER-LEVEL MIDDLEWARE

ğŸ“„ Controller

public function __construct()
{
    $this->middleware(['auth', 'role:admin']);
}

PART 6ï¸âƒ£ â€” SHOW/HIDE IN BLADE
@if(auth()->user()->role === 'admin')
    <a href="/admin/dashboard">Admin Panel</a>
@endif


Or create helper:

function isAdmin() {
    return auth()->check() && auth()->user()->role === 'admin';
}

PART 7ï¸âƒ£ â€” OPTIONAL: USE ENUM (ADVANCED ğŸ”¥)

Instead of string:

$table->enum('role', ['admin', 'user'])->default('user');
